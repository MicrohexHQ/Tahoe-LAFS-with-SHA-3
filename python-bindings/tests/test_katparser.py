import unittest

from katparser import KAT

class TestKATParser(unittest.TestCase):
    def setUp(self):
        fixture = """
# Comments should be ignored

Len = 0
Msg = 00
MD = 82CAC4BF6F4C2B41FBCC0E0984E9D8B76D7662F8E1789CDFBD85682ACC55577A

Len = 1546
Msg = F535558E373874104E154A503F82CBCAADD4617A38E9670CB3C012869DF16AF75DB0E9AC8\
866A48576A3EB212533E1064A60AC17AF43BF47A7D2464D93BF2261D0DA09A9F97D4FB5881CAE75\
B065E9F76967EB9E39A4770889423649B70CD15F1E091A8950C51F3AA29F66E99BC8C0846276258\
99FAE82846CEF1979A94E29D9AA90C0C5E32A30BE520E7E7BB5EF0E9CB8CC5D2E9E7F41C37EBA00\
17C427417543744915A77B72DDC3161929ADBA0B992E9EC3B8626348DC889383D38060A8589DC0
MD = 43D51D5B14185275245D1D7DAB95DE239503B1F17E04A8A35D02373CF35DF835

Len = 1547
Msg = 4AFB68BB38DAF4C64A43D0892DE39CF0EE0B24499F434BE306967C933CECB3412F0DAA124\
E67FF1A58BB26C9FC9F91B6401317B84E0047D4B6E57D2F3D9C88459D1603B2748983A8C3B4CFE6\
E81EB9DBC299BA3927A3E1F76A5F54812EB9037189EAE3B19417B8F48CEB2C025F122DB62036FA4\
290B38DDB90A9687008A1B7D67DF503371785D1C7519FBE21B5B09C448FA69EE914355C95230D44\
6CDBAA90DBDF354AF8C86E01DA389F02296A6B86153A078467B85885D276AD00216FF797B68C40
MD = 7969E6EE99A1B551A4554B620602E4DF6E2A9ADA8E097F5E3C74D001FFEDF60E
"""
        fn = '/tmp/KAT_fixture_test'
        f = open(fn, 'w')
        f.write(fixture)
        f.close()

        self.kat = KAT(fn)

    def test_that_no_file_given_raises_valu_error(self):
        self.assertRaises(ValueError, KAT)

    def test_that_get_known_answers_returns_3_elements_from_fixtures(self):
        self.assertEquals(len(self.kat.get_known_answers()), 3)

    def test_that_second_KAT_len_is_int_1546(self):
        self.assertEquals(self.kat.get_known_answers()[1][0], 1546)

    def test_that_third_KAT_MD_is_correct(self):
        self.assertEquals(self.kat.get_known_answers()[2][2],
            '7969E6EE99A1B551A4554B620602E4DF6E2A9ADA8E097F5E3C74D001FFEDF60E')

if __name__ == '__main__':
    unittest.main()
